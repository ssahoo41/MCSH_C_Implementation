#include "calculate_gmpordernorm.h"
#include <stdio.h>

int main(){
    double cell[3][3] = {{8.97319403,0.,0.},{0.,7.32658224,0.},{0.,0.,28.52709616}};
    double *cell_p[3];
    double ** cell_all;
    for (int i =0; i < 3; i ++){
        cell_p[i] = cell[i];
    }
    cell_all = cell_p;

    double cart[44][3] = {{0.74680833,1.42942923,19.98769606},
    {3.73820783,1.42953548,19.98861346},
    {6.72830948,1.45253538,19.99588392},
    {2.24150573,6.45767843,19.23817225},
    {5.23673389,6.46044654,19.2555065,},
    {8.22083662,6.46104993,19.25519614},
    {0.73899619,4.02163277,18.73013775},
    {3.74474425,4.02401282,18.71881127},
    {6.7286711,4.03204329,18.75785895},
    {2.2427903,1.74099816,17.66108169},
    {5.23603987,1.73218126,17.66293431},
    {8.22103058,1.73039741,17.66350217},
    {0.74248825,6.11611472,16.85544561},
    {3.74236588,6.1217025,16.8535779,},
    {6.73013411,6.11741517,16.85925079},
    {2.24352998,3.82432455,15.94024139},
    {5.23748982,3.82427,15.94728012},
    {8.22280112,3.82211029,15.94700472},
    {0.74776207,1.2602581,15.27578743},
    {3.73882376,1.2602581,15.27578743},
    {6.72989441,1.2602581,15.27578743},
    {2.24328843,6.14464871,14.41234837},
    {5.23435908,6.14464871,14.41234837},
    {8.22542077,6.14464871,14.41234837},
    {0.74776207,3.70244974,13.54888786},
    {3.73882376,3.70244974,13.54888786},
    {6.72989441,3.70244974,13.54888786},
    {2.24328843,1.2602581,12.6854488},
    {5.23435908,1.2602581,12.6854488},
    {8.22542077,1.2602581,12.6854488},
    {0.74776207,6.14464871,11.82200974},
    {3.73882376,6.14464871,11.82200974},
    {6.72989441,6.14464871,11.82200974},
    {2.24328843,3.70244974,10.95854922},
    {5.23435908,3.70244974,10.95854922},
    {8.22542077,3.70244974,10.95854922},
    {1.60310708,4.62016482,23.70039717},
    {2.31796685,4.29798172,22.3912125,},
    {1.0512493,5.56954944,23.63004981},
    {2.31226405,4.71273828,24.53556743},
    {2.98287474,5.11775306,22.07441729},
    {1.60055145,4.12926517,21.57217004},
    {0.87713341,3.83791071,23.96473073},
    {2.93720532,3.38932111,22.46936279}};

    double *cart_p[44];
    double ** cart_all;

    for (int i =0; i < 44; i ++){
            cart_p[i] = cart[i];
        }
    cart_all = cart_p;

    double scale[44][3] = {{0.08322659,0.19510178,0.70065652},
    {0.41659724,0.19511628,0.70068868},
    {0.74982325,0.19825552,0.70094355},
    {0.24980021,0.88140394,0.67438242},
    {0.58359753,0.88178175,0.67499007},
    {0.916155,0.88186411,0.67497919},
    {0.08235598,0.5489098,0.65657358},
    {0.41732567,0.54923465,0.65617654},
    {0.74986355,0.55033072,0.65754533},
    {0.24994336,0.2376276,0.61909847},
    {0.58352019,0.23642419,0.61916342},
    {0.91617662,0.23618071,0.61918332},
    {0.08274515,0.83478415,0.59085739},
    {0.41706062,0.83554682,0.59079192},
    {0.75002659,0.83496165,0.59099078},
    {0.2500258,0.52197934,0.55877546},
    {0.58368178,0.52197189,0.5590222,},
    {0.91637393,0.52167712,0.55901255},
    {0.08333288,0.17201173,0.53548343},
    {0.41666588,0.17201173,0.53548343},
    {0.74999988,0.17201173,0.53548343},
    {0.24999888,0.83867873,0.5052161,},
    {0.58333288,0.83867873,0.5052161,},
    {0.91666588,0.83867873,0.5052161,},
    {0.08333288,0.50534473,0.47494802},
    {0.41666588,0.50534473,0.47494802},
    {0.74999988,0.50534473,0.47494802},
    {0.24999888,0.17201173,0.44468069},
    {0.58333288,0.17201173,0.44468069},
    {0.91666588,0.17201173,0.44468069},
    {0.08333288,0.83867873,0.41441336},
    {0.41666588,0.83867873,0.41441336},
    {0.74999988,0.83867873,0.41441336},
    {0.24999888,0.50534473,0.38414528},
    {0.58333288,0.50534473,0.38414528},
    {0.91666588,0.50534473,0.38414528},
    {0.17865512,0.63060301,0.830803,},
    {0.25832127,0.58662847,0.78491033},
    {0.11715441,0.76018384,0.82833702},
    {0.25768573,0.6432383,0.86007939},
    {0.33242062,0.69851848,0.77380527},
    {0.17837032,0.56360047,0.7561993,},
    {0.09775041,0.5238337,0.84006906},
    {0.32733108,0.46260603,0.78764984}};

    double *scale_p[44];
    double ** scale_all;

    for (int i =0; i < 44; i ++){
            scale_p[i] = scale[i];
        }
    scale_all = scale_p;

    int pbc[3] = {1,1,1}; 
    int *pbc_p = pbc;

    int atom_indices[44] = {79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,6,6,1,1,1,1,1,1};
    int *atom_indices_p = atom_indices;
    int atom_num = 44;
    int cal_atoms[2] = {36,37};
    int *cal_atoms_p = cal_atoms;
    int cal_num = 2;

    int params_i[15][3] = {{0,1,0},
    {0,1,0},
    {0,1,0},
    {1,1,0},
    {1,1,0},
    {1,1,0},
    {2,1,0},
    {2,1,0},
    {2,1,0},
    {3,1,0},
    {3,1,0},
    {3,1,0},
    {4,1,0},
    {4,1,0},
    {4,1,0}};
    int *params_ip[15];
    int **params_ip_all;
    for (int i =0; i < 15; i ++){
            params_ip[i] = params_i[i];
        }
    params_ip_all = params_ip;

    double params_d[15][6] = {{1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00}};

    double *params_dp[15];
    double **params_dp_all;
    for (int i =0; i < 15; i ++){
            params_dp[i] = params_d[i];
        }
    params_dp_all = params_dp;

    int nmcsh = 15;

    double atom_gaussian[7][12] = {{1.18508086e+00,1.09138014e+00,2.33780444e+03,1.19153115e+01
    ,6.32016327e+01,5.80717093e+00,-2.39524586e+03,1.18145155e+01
    ,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00},
    {-2.11565175e+03,4.76796442e+00,-6.03186368e+02,1.49540036e+01
    ,2.14585000e+03,4.76800516e+00,1.02093893e+03,1.59805744e+01
    ,-4.42445584e+02,1.69594315e+01,1.61060434e+00,1.15246327e+00},
    {-1.89497893e+00,1.48991693e+01,3.41152646e-01,1.02616758e+00
    ,-3.80495085e-01,3.24116879e+01,2.19001711e+00,2.98127984e+00
    ,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00},
    {3.58183509e-01,1.74903622e+00,9.54354963e-01,1.15139501e+01
    ,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00
    ,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00},
    {1.24169482e+00,1.08471703e+00,2.42445030e+03,1.13353153e+01
    ,6.74490058e+01,6.01501714e+00,-2.48681769e+03,1.12428153e+01
    ,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00},
    {-2.18105985e+03,4.48450788e+00,-5.71952362e+02,1.53792106e+01
    ,2.20526103e+03,4.48450331e+00,1.24072188e+03,1.62906631e+01
    ,-6.88388280e+02,1.68542970e+01,1.38643778e+00,1.07260777e+00},
    {8.36619396e-01,9.13560275e-01,2.62426625e+03,8.31445424e+00
    ,7.03676197e+01,5.35612632e+00,-2.68985158e+03,8.27276549e+00
    ,0.00000000e+00,0.00000000e+00,0.00000000e+00,0.00000000e+00}};

    double *atom_gaussian_p[7];
    double **atom_gaussian_all;
    for (int i =0; i < 7; i ++){
            atom_gaussian_p[i] = atom_gaussian[i];
        }
    atom_gaussian_all = atom_gaussian_p;

    int ngaussians[7] = {4,6,4,2,4,6,4};
    int *ngaussians_p = ngaussians;
    int element_index_to_order[120] = {0,3,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    int *element_index_to_order_p = element_index_to_order;

    double x[2][15] = {{0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.},
    {0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.}};
    double *x_p[2];
    double **x_all;
    for (int i = 0; i <2; i ++){
        x_p[i] = x[i];
    }
    x_all = x_p;
    printf("Made it to calc");
    calculate_gmpordernorm_noderiv(cell_all,cart_all,scale_all,pbc_p,atom_indices_p,atom_num,cal_atoms_p,cal_num,params_ip_all,params_dp_all,nmcsh,atom_gaussian_all,ngaussians_p,element_index_to_order_p,x_all);

    for (int i = 0; i < 2; i ++) {
        for (int j = 0; j < 15; j ++) {
            printf("%d,%d: %f\n",i,j,x_all[i][j]);
        }
    }

    return 0;
}