#include "calculate_gmpordernorm.h"
#include <stdio.h>

int main(){
    double cell[3][3] = {{12.15,0.,0.},{0.,12.15,0.},{0.,0.,12.15}};
    double *cell_p[3];
    double ** cell_all;
    for (int i =0; i < 3; i ++){
        cell_p[i] = cell[i];
    }
    cell_all = cell_p;

    double cart[108][3] = {{0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00},{0.000000000000000000e+00,2.024999999999999911e+00,2.024999999999999911e+00},{2.024999999999999911e+00,0.000000000000000000e+00,2.024999999999999911e+00},{2.024999999999999911e+00,2.024999999999999911e+00,0.000000000000000000e+00},{0.000000000000000000e+00,0.000000000000000000e+00,4.049999999999999822e+00},{0.000000000000000000e+00,2.024999999999999911e+00,6.074999999999999289e+00},{2.024999999999999911e+00,0.000000000000000000e+00,6.074999999999999289e+00},{2.024999999999999911e+00,2.024999999999999911e+00,4.049999999999999822e+00},{0.000000000000000000e+00,0.000000000000000000e+00,8.099999999999999645e+00},{0.000000000000000000e+00,2.024999999999999911e+00,1.012500000000000000e+01},{2.024999999999999911e+00,0.000000000000000000e+00,1.012500000000000000e+01},{2.024999999999999911e+00,2.024999999999999911e+00,8.099999999999999645e+00},{0.000000000000000000e+00,4.049999999999999822e+00,0.000000000000000000e+00},{0.000000000000000000e+00,6.074999999999999289e+00,2.024999999999999911e+00},{2.024999999999999911e+00,4.049999999999999822e+00,2.024999999999999911e+00},{2.024999999999999911e+00,6.074999999999999289e+00,0.000000000000000000e+00},{0.000000000000000000e+00,4.049999999999999822e+00,4.049999999999999822e+00},{0.000000000000000000e+00,6.074999999999999289e+00,6.074999999999999289e+00},{2.024999999999999911e+00,4.049999999999999822e+00,6.074999999999999289e+00},{2.024999999999999911e+00,6.074999999999999289e+00,4.049999999999999822e+00},{0.000000000000000000e+00,4.049999999999999822e+00,8.099999999999999645e+00},{0.000000000000000000e+00,6.074999999999999289e+00,1.012500000000000000e+01},{2.024999999999999911e+00,4.049999999999999822e+00,1.012500000000000000e+01},{2.024999999999999911e+00,6.074999999999999289e+00,8.099999999999999645e+00},{0.000000000000000000e+00,8.099999999999999645e+00,0.000000000000000000e+00},{0.000000000000000000e+00,1.012500000000000000e+01,2.024999999999999911e+00},{2.024999999999999911e+00,8.099999999999999645e+00,2.024999999999999911e+00},{2.024999999999999911e+00,1.012500000000000000e+01,0.000000000000000000e+00},{0.000000000000000000e+00,8.099999999999999645e+00,4.049999999999999822e+00},{0.000000000000000000e+00,1.012500000000000000e+01,6.074999999999999289e+00},{2.024999999999999911e+00,8.099999999999999645e+00,6.074999999999999289e+00},{2.024999999999999911e+00,1.012500000000000000e+01,4.049999999999999822e+00},{0.000000000000000000e+00,8.099999999999999645e+00,8.099999999999999645e+00},{0.000000000000000000e+00,1.012500000000000000e+01,1.012500000000000000e+01},{2.024999999999999911e+00,8.099999999999999645e+00,1.012500000000000000e+01},{2.024999999999999911e+00,1.012500000000000000e+01,8.099999999999999645e+00},{4.049999999999999822e+00,0.000000000000000000e+00,0.000000000000000000e+00},{4.049999999999999822e+00,2.024999999999999911e+00,2.024999999999999911e+00},{6.074999999999999289e+00,0.000000000000000000e+00,2.024999999999999911e+00},{6.074999999999999289e+00,2.024999999999999911e+00,0.000000000000000000e+00},{4.049999999999999822e+00,0.000000000000000000e+00,4.049999999999999822e+00},{4.049999999999999822e+00,2.024999999999999911e+00,6.074999999999999289e+00},{6.074999999999999289e+00,0.000000000000000000e+00,6.074999999999999289e+00},{6.074999999999999289e+00,2.024999999999999911e+00,4.049999999999999822e+00},{4.049999999999999822e+00,0.000000000000000000e+00,8.099999999999999645e+00},{4.049999999999999822e+00,2.024999999999999911e+00,1.012500000000000000e+01},{6.074999999999999289e+00,0.000000000000000000e+00,1.012500000000000000e+01},{6.074999999999999289e+00,2.024999999999999911e+00,8.099999999999999645e+00},{4.049999999999999822e+00,4.049999999999999822e+00,0.000000000000000000e+00},{4.049999999999999822e+00,6.074999999999999289e+00,2.024999999999999911e+00},{6.074999999999999289e+00,4.049999999999999822e+00,2.024999999999999911e+00},{6.074999999999999289e+00,6.074999999999999289e+00,0.000000000000000000e+00},{4.049999999999999822e+00,4.049999999999999822e+00,4.049999999999999822e+00},{4.049999999999999822e+00,6.074999999999999289e+00,6.074999999999999289e+00},{6.074999999999999289e+00,4.049999999999999822e+00,6.074999999999999289e+00},{6.074999999999999289e+00,6.074999999999999289e+00,4.049999999999999822e+00},{4.049999999999999822e+00,4.049999999999999822e+00,8.099999999999999645e+00},{4.049999999999999822e+00,6.074999999999999289e+00,1.012500000000000000e+01},{6.074999999999999289e+00,4.049999999999999822e+00,1.012500000000000000e+01},{6.074999999999999289e+00,6.074999999999999289e+00,8.099999999999999645e+00},{4.049999999999999822e+00,8.099999999999999645e+00,0.000000000000000000e+00},{4.049999999999999822e+00,1.012500000000000000e+01,2.024999999999999911e+00},{6.074999999999999289e+00,8.099999999999999645e+00,2.024999999999999911e+00},{6.074999999999999289e+00,1.012500000000000000e+01,0.000000000000000000e+00},{4.049999999999999822e+00,8.099999999999999645e+00,4.049999999999999822e+00},{4.049999999999999822e+00,1.012500000000000000e+01,6.074999999999999289e+00},{6.074999999999999289e+00,8.099999999999999645e+00,6.074999999999999289e+00},{6.074999999999999289e+00,1.012500000000000000e+01,4.049999999999999822e+00},{4.049999999999999822e+00,8.099999999999999645e+00,8.099999999999999645e+00},{4.049999999999999822e+00,1.012500000000000000e+01,1.012500000000000000e+01},{6.074999999999999289e+00,8.099999999999999645e+00,1.012500000000000000e+01},{6.074999999999999289e+00,1.012500000000000000e+01,8.099999999999999645e+00},{8.099999999999999645e+00,0.000000000000000000e+00,0.000000000000000000e+00},{8.099999999999999645e+00,2.024999999999999911e+00,2.024999999999999911e+00},{1.012500000000000000e+01,0.000000000000000000e+00,2.024999999999999911e+00},{1.012500000000000000e+01,2.024999999999999911e+00,0.000000000000000000e+00},{8.099999999999999645e+00,0.000000000000000000e+00,4.049999999999999822e+00},{8.099999999999999645e+00,2.024999999999999911e+00,6.074999999999999289e+00},{1.012500000000000000e+01,0.000000000000000000e+00,6.074999999999999289e+00},{1.012500000000000000e+01,2.024999999999999911e+00,4.049999999999999822e+00},{8.099999999999999645e+00,0.000000000000000000e+00,8.099999999999999645e+00},{8.099999999999999645e+00,2.024999999999999911e+00,1.012500000000000000e+01},{1.012500000000000000e+01,0.000000000000000000e+00,1.012500000000000000e+01},{1.012500000000000000e+01,2.024999999999999911e+00,8.099999999999999645e+00},{8.099999999999999645e+00,4.049999999999999822e+00,0.000000000000000000e+00},{8.099999999999999645e+00,6.074999999999999289e+00,2.024999999999999911e+00},{1.012500000000000000e+01,4.049999999999999822e+00,2.024999999999999911e+00},{1.012500000000000000e+01,6.074999999999999289e+00,0.000000000000000000e+00},{8.099999999999999645e+00,4.049999999999999822e+00,4.049999999999999822e+00},{8.099999999999999645e+00,6.074999999999999289e+00,6.074999999999999289e+00},{1.012500000000000000e+01,4.049999999999999822e+00,6.074999999999999289e+00},{1.012500000000000000e+01,6.074999999999999289e+00,4.049999999999999822e+00},{8.099999999999999645e+00,4.049999999999999822e+00,8.099999999999999645e+00},{8.099999999999999645e+00,6.074999999999999289e+00,1.012500000000000000e+01},{1.012500000000000000e+01,4.049999999999999822e+00,1.012500000000000000e+01},{1.012500000000000000e+01,6.074999999999999289e+00,8.099999999999999645e+00},{8.099999999999999645e+00,8.099999999999999645e+00,0.000000000000000000e+00},{8.099999999999999645e+00,1.012500000000000000e+01,2.024999999999999911e+00},{1.012500000000000000e+01,8.099999999999999645e+00,2.024999999999999911e+00},{1.012500000000000000e+01,1.012500000000000000e+01,0.000000000000000000e+00},{8.099999999999999645e+00,8.099999999999999645e+00,4.049999999999999822e+00},{8.099999999999999645e+00,1.012500000000000000e+01,6.074999999999999289e+00},{1.012500000000000000e+01,8.099999999999999645e+00,6.074999999999999289e+00},{1.012500000000000000e+01,1.012500000000000000e+01,4.049999999999999822e+00},{8.099999999999999645e+00,8.099999999999999645e+00,8.099999999999999645e+00},{8.099999999999999645e+00,1.012500000000000000e+01,1.012500000000000000e+01},{1.012500000000000000e+01,8.099999999999999645e+00,1.012500000000000000e+01},{1.012500000000000000e+01,1.012500000000000000e+01,8.099999999999999645e+00}};


    double *cart_p[108];
    double ** cart_all;

    for (int i =0; i < 108; i ++){
            cart_p[i] = cart[i];
        }
    cart_all = cart_p;

    double scale[108][3] = {{0.000000000000000000e+00,0.000000000000000000e+00,0.000000000000000000e+00},{0.000000000000000000e+00,1.666666666666666852e-01,1.666666666666666852e-01},{1.666666666666666852e-01,0.000000000000000000e+00,1.666666666666666852e-01},{1.666666666666666852e-01,1.666666666666666852e-01,0.000000000000000000e+00},{0.000000000000000000e+00,0.000000000000000000e+00,3.333333333333333703e-01},{0.000000000000000000e+00,1.666666666666666852e-01,5.000000000000000000e-01},{1.666666666666666852e-01,0.000000000000000000e+00,5.000000000000000000e-01},{1.666666666666666852e-01,1.666666666666666852e-01,3.333333333333333703e-01},{0.000000000000000000e+00,0.000000000000000000e+00,6.666666666666667407e-01},{0.000000000000000000e+00,1.666666666666666852e-01,8.333333333333334814e-01},{1.666666666666666852e-01,0.000000000000000000e+00,8.333333333333334814e-01},{1.666666666666666852e-01,1.666666666666666852e-01,6.666666666666667407e-01},{0.000000000000000000e+00,3.333333333333333703e-01,0.000000000000000000e+00},{0.000000000000000000e+00,5.000000000000000000e-01,1.666666666666666852e-01},{1.666666666666666852e-01,3.333333333333333703e-01,1.666666666666666852e-01},{1.666666666666666852e-01,5.000000000000000000e-01,0.000000000000000000e+00},{0.000000000000000000e+00,3.333333333333333703e-01,3.333333333333333703e-01},{0.000000000000000000e+00,5.000000000000000000e-01,5.000000000000000000e-01},{1.666666666666666852e-01,3.333333333333333703e-01,5.000000000000000000e-01},{1.666666666666666852e-01,5.000000000000000000e-01,3.333333333333333703e-01},{0.000000000000000000e+00,3.333333333333333703e-01,6.666666666666667407e-01},{0.000000000000000000e+00,5.000000000000000000e-01,8.333333333333334814e-01},{1.666666666666666852e-01,3.333333333333333703e-01,8.333333333333334814e-01},{1.666666666666666852e-01,5.000000000000000000e-01,6.666666666666667407e-01},{0.000000000000000000e+00,6.666666666666667407e-01,0.000000000000000000e+00},{0.000000000000000000e+00,8.333333333333334814e-01,1.666666666666666852e-01},{1.666666666666666852e-01,6.666666666666667407e-01,1.666666666666666852e-01},{1.666666666666666852e-01,8.333333333333334814e-01,0.000000000000000000e+00},{0.000000000000000000e+00,6.666666666666667407e-01,3.333333333333333703e-01},{0.000000000000000000e+00,8.333333333333334814e-01,5.000000000000000000e-01},{1.666666666666666852e-01,6.666666666666667407e-01,5.000000000000000000e-01},{1.666666666666666852e-01,8.333333333333334814e-01,3.333333333333333703e-01},{0.000000000000000000e+00,6.666666666666667407e-01,6.666666666666667407e-01},{0.000000000000000000e+00,8.333333333333334814e-01,8.333333333333334814e-01},{1.666666666666666852e-01,6.666666666666667407e-01,8.333333333333334814e-01},{1.666666666666666852e-01,8.333333333333334814e-01,6.666666666666667407e-01},{3.333333333333333703e-01,0.000000000000000000e+00,0.000000000000000000e+00},{3.333333333333333703e-01,1.666666666666666852e-01,1.666666666666666852e-01},{5.000000000000000000e-01,0.000000000000000000e+00,1.666666666666666852e-01},{5.000000000000000000e-01,1.666666666666666852e-01,0.000000000000000000e+00},{3.333333333333333703e-01,0.000000000000000000e+00,3.333333333333333703e-01},{3.333333333333333703e-01,1.666666666666666852e-01,5.000000000000000000e-01},{5.000000000000000000e-01,0.000000000000000000e+00,5.000000000000000000e-01},{5.000000000000000000e-01,1.666666666666666852e-01,3.333333333333333703e-01},{3.333333333333333703e-01,0.000000000000000000e+00,6.666666666666667407e-01},{3.333333333333333703e-01,1.666666666666666852e-01,8.333333333333334814e-01},{5.000000000000000000e-01,0.000000000000000000e+00,8.333333333333334814e-01},{5.000000000000000000e-01,1.666666666666666852e-01,6.666666666666667407e-01},{3.333333333333333703e-01,3.333333333333333703e-01,0.000000000000000000e+00},{3.333333333333333703e-01,5.000000000000000000e-01,1.666666666666666852e-01},{5.000000000000000000e-01,3.333333333333333703e-01,1.666666666666666852e-01},{5.000000000000000000e-01,5.000000000000000000e-01,0.000000000000000000e+00},{3.333333333333333703e-01,3.333333333333333703e-01,3.333333333333333703e-01},{3.333333333333333703e-01,5.000000000000000000e-01,5.000000000000000000e-01},{5.000000000000000000e-01,3.333333333333333703e-01,5.000000000000000000e-01},{5.000000000000000000e-01,5.000000000000000000e-01,3.333333333333333703e-01},{3.333333333333333703e-01,3.333333333333333703e-01,6.666666666666667407e-01},{3.333333333333333703e-01,5.000000000000000000e-01,8.333333333333334814e-01},{5.000000000000000000e-01,3.333333333333333703e-01,8.333333333333334814e-01},{5.000000000000000000e-01,5.000000000000000000e-01,6.666666666666667407e-01},{3.333333333333333703e-01,6.666666666666667407e-01,0.000000000000000000e+00},{3.333333333333333703e-01,8.333333333333334814e-01,1.666666666666666852e-01},{5.000000000000000000e-01,6.666666666666667407e-01,1.666666666666666852e-01},{5.000000000000000000e-01,8.333333333333334814e-01,0.000000000000000000e+00},{3.333333333333333703e-01,6.666666666666667407e-01,3.333333333333333703e-01},{3.333333333333333703e-01,8.333333333333334814e-01,5.000000000000000000e-01},{5.000000000000000000e-01,6.666666666666667407e-01,5.000000000000000000e-01},{5.000000000000000000e-01,8.333333333333334814e-01,3.333333333333333703e-01},{3.333333333333333703e-01,6.666666666666667407e-01,6.666666666666667407e-01},{3.333333333333333703e-01,8.333333333333334814e-01,8.333333333333334814e-01},{5.000000000000000000e-01,6.666666666666667407e-01,8.333333333333334814e-01},{5.000000000000000000e-01,8.333333333333334814e-01,6.666666666666667407e-01},{6.666666666666667407e-01,0.000000000000000000e+00,0.000000000000000000e+00},{6.666666666666667407e-01,1.666666666666666852e-01,1.666666666666666852e-01},{8.333333333333334814e-01,0.000000000000000000e+00,1.666666666666666852e-01},{8.333333333333334814e-01,1.666666666666666852e-01,0.000000000000000000e+00},{6.666666666666667407e-01,0.000000000000000000e+00,3.333333333333333703e-01},{6.666666666666667407e-01,1.666666666666666852e-01,5.000000000000000000e-01},{8.333333333333334814e-01,0.000000000000000000e+00,5.000000000000000000e-01},{8.333333333333334814e-01,1.666666666666666852e-01,3.333333333333333703e-01},{6.666666666666667407e-01,0.000000000000000000e+00,6.666666666666667407e-01},{6.666666666666667407e-01,1.666666666666666852e-01,8.333333333333334814e-01},{8.333333333333334814e-01,0.000000000000000000e+00,8.333333333333334814e-01},{8.333333333333334814e-01,1.666666666666666852e-01,6.666666666666667407e-01},{6.666666666666667407e-01,3.333333333333333703e-01,0.000000000000000000e+00},{6.666666666666667407e-01,5.000000000000000000e-01,1.666666666666666852e-01},{8.333333333333334814e-01,3.333333333333333703e-01,1.666666666666666852e-01},{8.333333333333334814e-01,5.000000000000000000e-01,0.000000000000000000e+00},{6.666666666666667407e-01,3.333333333333333703e-01,3.333333333333333703e-01},{6.666666666666667407e-01,5.000000000000000000e-01,5.000000000000000000e-01},{8.333333333333334814e-01,3.333333333333333703e-01,5.000000000000000000e-01},{8.333333333333334814e-01,5.000000000000000000e-01,3.333333333333333703e-01},{6.666666666666667407e-01,3.333333333333333703e-01,6.666666666666667407e-01},{6.666666666666667407e-01,5.000000000000000000e-01,8.333333333333334814e-01},{8.333333333333334814e-01,3.333333333333333703e-01,8.333333333333334814e-01},{8.333333333333334814e-01,5.000000000000000000e-01,6.666666666666667407e-01},{6.666666666666667407e-01,6.666666666666667407e-01,0.000000000000000000e+00},{6.666666666666667407e-01,8.333333333333334814e-01,1.666666666666666852e-01},{8.333333333333334814e-01,6.666666666666667407e-01,1.666666666666666852e-01},{8.333333333333334814e-01,8.333333333333334814e-01,0.000000000000000000e+00},{6.666666666666667407e-01,6.666666666666667407e-01,3.333333333333333703e-01},{6.666666666666667407e-01,8.333333333333334814e-01,5.000000000000000000e-01},{8.333333333333334814e-01,6.666666666666667407e-01,5.000000000000000000e-01},{8.333333333333334814e-01,8.333333333333334814e-01,3.333333333333333703e-01},{6.666666666666667407e-01,6.666666666666667407e-01,6.666666666666667407e-01},{6.666666666666667407e-01,8.333333333333334814e-01,8.333333333333334814e-01},{8.333333333333334814e-01,6.666666666666667407e-01,8.333333333333334814e-01},{8.333333333333334814e-01,8.333333333333334814e-01,6.666666666666667407e-01}};

    double *scale_p[108];
    double ** scale_all;

    for (int i =0; i < 108; i ++){
            scale_p[i] = scale[i];
        }
    scale_all = scale_p;

    int pbc[3] = {1,1,1}; 
    int *pbc_p = pbc;

    int atom_indices[108];
    for (int i =0; i < 108; i ++) atom_indices[i] = 13;
    int *atom_indices_p = atom_indices;
    int atom_num = 108;
    int cal_atoms[108];
    for (int i =0; i<108; i++) cal_atoms[i] = i;
    int *cal_atoms_p = cal_atoms;
    int cal_num = 108;

    int params_i[15][3] = {{0,1,0},
    {0,1,0},
    {0,1,0},
    {1,1,0},
    {1,1,0},
    {1,1,0},
    {2,1,0},
    {2,1,0},
    {2,1,0},
    {3,1,0},
    {3,1,0},
    {3,1,0},
    {4,1,0},
    {4,1,0},
    {4,1,0}};
    int *params_ip[15];
    int **params_ip_all;
    for (int i =0; i < 15; i ++){
            params_ip[i] = params_i[i];
        }
    params_ip_all = params_ip;

    double params_d[15][6] = {{1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00},
    {1.00000000e-01,1.00000000e+00,6.34936359e+01,5.00000000e+01,
    1.80000000e+01,1.00000000e+00},
    {6.30000000e-01,1.00000000e+00,2.53926805e-01,1.25976316e+00,
    1.80000000e+01,1.00000000e+00},
    {3.98000000e+00,1.00000000e+00,1.00711945e-03,3.15648595e-02,
    1.80000000e+01,1.00000000e+00}};

    double *params_dp[15];
    double **params_dp_all;
    for (int i =0; i < 15; i ++){
            params_dp[i] = params_d[i];
        }
    params_dp_all = params_dp;

    int nmcsh = 15;

    double atom_gaussian[1][8] = {{0.3730494069109985,0.7344318799434225,516.9378247134416,13.577027904536275,
    889298.9729349068,12.0315655354449,-889796.765560644,12.032681865001077}};

    double *atom_gaussian_p[1];
    double **atom_gaussian_all;
    for (int i =0; i < 1; i ++){
            atom_gaussian_p[i] = atom_gaussian[i];
        }
    atom_gaussian_all = atom_gaussian_p;

    int ngaussians[1] = {4};
    int *ngaussians_p = ngaussians;
    int element_index_to_order[120] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    int *element_index_to_order_p = element_index_to_order;

    double x[108][15];
    for (int i = 0; i < 108; i++){
        for (int j = 0; j < 15; j++){
            x[i][j] = 0.0;
        }
    }
    double *x_p[108];
    double **x_all;
    for (int i = 0; i <108; i ++){
        x_p[i] = x[i];
    }
    x_all = x_p;

    double dx[108*15][324];
    for (int i = 0; i < 108*15; i++){
        for (int j = 0; j < 324; j++){
            dx[i][j] = 0.0;
        }
    }
    double *dx_p[108*15];
    double **dx_all;
    for (int i = 0; i < 108*15; i ++) dx_p[i] = dx[i];
    dx_all = dx_p;

    calculate_gmpordernorm(cell_all,cart_all,scale_all,pbc_p,atom_indices_p,atom_num,cal_atoms_p,cal_num,params_ip_all,params_dp_all,nmcsh,atom_gaussian_all,ngaussians_p,element_index_to_order_p,x_all,dx_all);

    for (int i = 0; i < 108; i ++) {
        for (int k = 6; k < 15; k++){
            for (int j = 0; j < 324; j ++) {
                printf(",%f",dx_all[i*15+k][j]);
            }
            printf("\n");
        }
    }

    return 0;
}